<!DOCTYPE html>
<html>
	<head>
		<title>Dashboard Diagram</title>
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
		<meta charset=utf-8 />
		<script src="http://cytoscape.github.io/cytoscape.js/api/cytoscape.js-latest/cytoscape.min.js"></script>
		<script src="lib/roslibjs/include/EventEmitter2/eventemitter2.js"></script>
		<script src="lib/roslibjs/build/roslib.js"></script>
		<script src="rosdash.js"></script>
		<style>
body { 
  font: 14px helvetica neue, helvetica, arial, sans-serif;
}
#cy {
  height: 100%;
  width: 100%;
  position: absolute;
  left: 0;
  top: 100;
}
		</style>
	</head>
	<body>
		<input type="text" name="host" id="host" value="localhost">
		<input type="text" name="topic" id="topic" value="">
		<input type="button" id="addtopic" value="add topic">
		<input type="button" id="addblock" value="add block">
		<input type="button" id="removeblock" value="remove block">
		<div id="cy"></div>
		<script type="text/javascript">
$(function() {
	$("#addtopic").click(ROSDASH.addTopicCallback);
	$("#addblock").click(ROSDASH.addBlockCallback);
	$("#removeblock").click(ROSDASH.removeBlockCallback);
	ROSDASH.initJson();
	var style = ROSDASH.default_style;
	var element = ROSDASH.default_element;
	var ros = new ROSLIB.Ros();
	ros.on('error', function(error) {
		console.log(error);
	});
	var host = $("#host").val();
	ros.connect('ws://' + host + ':9090');
	$.getJSON('file/test3-diagram.json', function(data)
	{
		var json = data.data;
		var ele = ROSDASH.transformToElements(json);
		$('#cy').cytoscape({
			layout: {
				name: 'circle'
			},
			style: style,
			elements: ele, //ROSDASH.default_element2,
			ready: function(){
				window.cy = this;
				window.cy.elements().unlock();
				window.cy.elements().unselect();
				ROSDASH.blockMoveCallback();
				ROSDASH.connectBlocksCallback();
				ROSDASH.getROSNames(ros);
			}
		});
	});
	$.getJSON('file/test4-diagram.json', function(data)
	{
		ROSDASH.loadDiagram(data);
	});
});
		</script>
	</body>
</html>
